교차 분석은 **범주형 변수가 여러 개인 경우**에 적용하는 분석 방법이다. 

카이제곱 교차 분석 역시 [[카이제곱 - 적합도 검정]]과 동일한 방법으로 아래와 같이 진행한다.
1.  가설 설정
2.  검정 통계량 계산(χ2)
3.  특정 자유도와 p-value에 따른 카이제곱 통계량 값을 얻는다.
4.  검정 통계량과 카이제곱 통계량 값을 비교하여 가설을 검정한다.

**주의사항**
-   가설 설정에 있어 귀무가설은 각 범주형 변수의 값이 동일하다(비율이 동일하다)는 것이고 대립가설은 동일하지 않다는 것이다.
-   검정 통계량이 카이제곱 값보다 작을 경우 귀무가설을 기각하지 못함으로 동일 비율 적합도가 "충분히 적합" 수준이다.
-   검정 통계량이 카이제곱 값보다 클 경우 귀무가설을 기각하여 동일 비율 적합도가 "충분히 적합하지 못함" 수준이다.

교차 분석의 목적은 여러 범주형 변수의 범주 간 차이가 기댓값에서 유의하게 벗어나는지 확인하는 것이다. 가령 아래와 같이 성별, 중국집 메뉴의 두 개의 범주형 변수에 대한 데이터를 확인해보자.
![<그림 10. 교차 분석을 수행하기 위한 데이터셋>|500](https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-12-13-chi_square/pic10.png)
<그림 10. 교차 분석을 수행하기 위한 데이터셋>
<br>
위 데이터 셋은 범주형 변수가 두 개이며 성별 변수에는 범주가 2개, 메뉴 변수에는 범주가 3개인 케이스이다.
교차 분석에서도 마찬가지로 [[카이제곱 통계량]]에서 제시하는 통계량을 사용할 수 있다.

이 때, 기댓값을 계산해야 하는데 각 cell의 기댓값은 다음과 같이 계산할 수 있다.

$$\text{기댓값} = \frac{\text{해당 행 전체 합}\times\text{해당 열 전체 합}}{\text{전체 데이터 수}}$$
![<그림 11. 교차 분석 데이터셋의 기대빈도를 계산하는 방법과 결과>|500](https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2021-12-13-chi_square/pic11.png)

<그림 11. 교차 분석 데이터셋의 기대빈도를 계산하는 방법과 결과>

<br>
그리고 교차분석 시 테이블의 행 갯수를 $r$, 열 갯수를 $c$라고 했을 때 자유도는 $(r-1)\times (c-1)$로 계산한다.

여기서 교차분석을 수행한다는 것은 각 메뉴별로 성별 간 선택의 차이를 보이는지, 혹은 각 성별 별로 메뉴 선택의 차이를 보이는지를 알아보는 것에 목적이 있다.

식 (2)에 따라 통계량을 구하면,

$$\chi^2 = \frac{(21-17.41)^2}{17.41} + \frac{(16-19.59)^2}{19.59} +

\frac{(13-13.18)^2}{13.18} \notag$$

$$+ \frac{(15-14.82)^2}{14.82} +

\frac{(6-9.41)^2}{9.41} + \frac{(14-10.59)^2}{10.59} = 3.7366$$

이 때, 자유도는 $(2-1)\times(3-1) = 2$ 이고 이 자유도에서 상위 95%에 해당하는 $\chi^2$ 값은

$$\chi^2(2)_{0.95} = 5.9915$$

임을 알 수 있다. 따라서, 따라서,$χ^2<χ^2(2)0.95$ 임으로 귀무 가설을 기각하지 못해 성별 및 메뉴판에 대해 기댓값에서 유의하게 벗어나지 않는 결과를 보인다는 것을 알 수 있다.